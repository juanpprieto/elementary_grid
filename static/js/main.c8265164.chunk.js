(this.webpackJsonpelementary_grid=this.webpackJsonpelementary_grid||[]).push([[0],{24:function(e,t,n){},29:function(e,t,n){},30:function(e,t,n){"use strict";n.r(t);var r,c=n(4),a=n.n(c),o=n(18),u=n.n(o),s=n(14),i=n(0),l=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16,n=1/(e/60);return 4*n/t*1e3},b=function(e){var t=["c","c#","d","d#","e","f","f#","g","g#","a","a#","b"],n=e.split(""),r=Object(i.a)(n,2),c=r[0],a=r[1];return t.indexOf(c)<0?-1:12*Number(a)+t.indexOf(c)},f=function(e){return e<0?0:440*Math.pow(2,(e-69)/12)},d=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Object(s.a)(Array.from(Array(e).keys()).map((function(e){return e+t})))},j=n(3),m=n(15),h=n(19),g=n.n(h),O=(n(24),n(1)),p=function(e){var t=e.hasHilight,n=e.label,r=e.note,c=e.onToggle,a=e.state,o=e.step,u=Object(m.a)(e,["hasHilight","label","note","onToggle","state","step"]),s=g()({"gs-key":!0,"gs-key--is-active":a,"gs-key--has-hilight":t}),i={"--step":o,"--note":r};return Object(O.jsx)("div",Object(j.a)(Object(j.a)({className:s,style:i,onClick:function(){return c(r)}},u),{},{children:Object(O.jsx)("div",{className:"gs-key__label",children:n})}))},v=function(e){var t=[];return d(e.length).forEach((function(n){d(e[0].length).forEach((function(r){var c=1===e[n][r],a="".concat(n,"_").concat(r,"_").concat(c?"on":"off");t.push({key:a,note:n,step:r,state:c,label:"s".concat(r,"n").concat(n)})}))})),t},x=function(e){var t=e.notes,n=e.hilightStep,r=e.onToggleNote,a=e.onClear,o=Object(c.useState)("none"),u=Object(i.a)(o,2),s=u[0],l=u[1],b=function(){return l("none")};Object(c.useEffect)((function(){return document.addEventListener("mouseup",b),function(){document.removeEventListener("mouseup",b)}}));var f={"--columns":t[0].length,"--rows":t.length},d={"--cursor":n};return Object(O.jsxs)("div",{className:"gs-grid",children:[Object(O.jsxs)("div",{className:"gs-grid__field",style:f,children:[v(t).map((function(e){var n=e.key,c=e.note,a=e.step,o=e.state,u=e.label;return Object(O.jsx)(p,{note:c,step:a,state:o,label:u,onToggle:function(){return r(c,a,o?0:1)},onMouseEnter:function(){return"none"!==s&&function(e,n){"fill"===s&&0===t[e][n]&&r(e,n,1),"clear"===s&&1===t[e][n]&&r(e,n,0)}(c,a)},onMouseDown:function(){return function(e,n){0===t[e][n]?(r(e,n,1),l("fill")):(r(e,n,0),l("clear"))}(c,a)}},n)})),Object(O.jsx)("div",{className:"gs-grid__cursor",style:d})]}),Object(O.jsx)("div",{className:"gs-grid__toolbar",children:Object(O.jsx)("button",{onClick:a,children:"Clear"})})]})},y=n(5),k=n.n(y),w=n(10),_=n(2);function E(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return _.b.mul(t,_.b.add(_.b.sin(_.b.mul(2*Math.PI,e)),_.b.sin(_.b.mul(3*Math.PI,e,.05))))}r||(console.log("creating a new AudioContext"),r=new AudioContext);var C=function(e){var t=e.scale,n=e.sequence,a=e.onMetro;return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:120,a=arguments.length>3?arguments[3]:void 0,o=Object(c.useState)(!1),u=Object(i.a)(o,2),s=u[0],b=u[1],f=Object(c.useRef)(_.b.metro({name:"tick",interval:l(n,16)})),j=Object(c.useRef)(_.b.metro({name:"sync",interval:l(n,1)})),m=Object(c.useRef)(0);Object(c.useEffect)((function(){!function(){var e=Object(w.a)(k.a.mark((function e(){return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_.a.initialize(r,{numberOfInputs:0,numberOfOutputs:1,outputChannelCount:[4]});case 2:e.sent.connect(r.destination),b(!0);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[]),Object(c.useEffect)((function(){_.a.on("metro",(function(e){"sync"===e.source&&(m.current=-1),"tick"===e.source&&(m.current=m.current+1,a(m.current))}))}),[]);var h=Object(c.useCallback)(Object(w.a)(k.a.mark((function c(){var a,o,u,i,b,m;return k.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:if("suspended"!==r.state){c.next=3;break}return c.next=3,r.resume();case 3:if(s&&"running"===r.state)try{a=function(t){return _.b.seq({seq:e[t],loop:!1},f.current,j.current)},o=function(e){return _.b.adsr(.01,.3,.1,1,a(e))},u=function(e){return _.b.add(_.b.mul(E(_.b.phasor(1.005*t[e]),.5)),_.b.mul(E(_.b.phasor(.995*t[e]),.5)))},i=function(e){return _.b.mul(o(e),u(e))},b=_.b.add(_.b.add(d(4,0).map(i)),_.b.add(d(4,4).map(i)),_.b.add(d(4,8).map(i)),_.b.add(d(4,12).map(i))),m=_.b.delay({size:44100},_.b.ms2samps(3*l(n,16)),-.3,b),b=_.b.add(_.b.mul(.5,b),_.b.mul(.15,m)),_.a.render(b,b,_.b.mul(0,f.current),_.b.mul(0,j.current))}catch(h){console.log(h)}case 4:case"end":return c.stop()}}),c)}))),[n,s,e,t]);Object(c.useEffect)((function(){h()}),[h,e])}(n,t.map(f),120,a),Object(O.jsx)(O.Fragment,{})},M=(n(29),function(){return Object(O.jsx)(O.Fragment,{children:Object(O.jsxs)("p",{children:["Made with ",Object(O.jsx)("a",{href:"https://www.elementary.audio/",children:"Elementary Audio"})]})})}),N=["c","d","f","g","a"],A=d(16).map((function(e){return"".concat(N[e%N.length]).concat(Math.floor(e/N.length)+4)})).flat(),S=function(){return Array.from(Array(16),(function(){return new Array(16).fill(0)}))};var T=function(){var e=Object(c.useState)(S()),t=Object(i.a)(e,2),n=t[0],r=t[1],a=Object(c.useState)(0),o=Object(i.a)(a,2),u=o[0],l=o[1];return Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)(C,{scale:A.map(b),sequence:n,onMetro:function(e){l(e)}}),Object(O.jsx)(x,{keyrange:16,notes:n,onToggleNote:function(e,t,c){var a=Object(s.a)(n);a[e][t]=c,r(a)},hilightStep:u,onClear:function(){return r(S())}}),Object(O.jsx)(M,{})]})};u.a.render(Object(O.jsx)(a.a.StrictMode,{children:Object(O.jsx)(T,{})}),document.getElementById("root"))}},[[30,1,2]]]);
//# sourceMappingURL=main.c8265164.chunk.js.map